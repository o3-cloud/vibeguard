---
summary: Removed unused inspector package dependency from init.go by inlining GenerateSetupPromptWithoutDetection into assist system
event_type: code
sources:
  - internal/cli/init.go
  - internal/cli/assist/composer.go
  - internal/cli/inspector/prompt.go
tags:
  - codebase-simplification
  - dependency-removal
  - assist-system
  - inspector-package
  - code-cleanup
  - refactoring
  - vibeguard-h58
---

# Inspector Package Removal and Assist System Simplification

## Overview
Successfully removed the unused `inspector` package dependency from `init.go` by inlining the `GenerateSetupPromptWithoutDetection` function directly into the `runAssist()` function. This simplification reduces coupling between modules while maintaining all existing functionality.

## Audit Results

### Inspector Package Usage Analysis
- **Single Usage Location**: Only `init.go:193` imported and used `inspector.GenerateSetupPromptWithoutDetection()`
- **No Assist System Usage**: The `internal/cli/assist/` package has zero direct inspector imports
- **Unused Functions**: The following functions remain unused and could be candidates for future deprecation:
  - `NewDetector()` - Project type detection
  - `NewToolScanner()` - Tool discovery
  - `NewMetadataExtractor()` - Project metadata extraction
  - `NewRecommender()` - Check recommendations
  - `DeduplicateRecommendations()` - Recommendation deduplication
  - `FilterByTools()` - Tool-based filtering
  - `GroupByCategory()` - Recommendation grouping
  - Original `GenerateSetupPrompt()` - Full detection-based prompt generation

### Refactoring Details

#### Before
```go
import "github.com/vibeguard/vibeguard/internal/cli/inspector"

// In runAssist():
prompt, err := inspector.GenerateSetupPromptWithoutDetection(root)
if err != nil {
    return &ExitError{Code: 3, Message: fmt.Sprintf("failed to generate setup prompt: %v", err)}
}
```

#### After
```go
import "github.com/vibeguard/vibeguard/internal/cli/assist"

// In runAssist():
projectName := filepath.Base(root)
analysis := &assist.ProjectAnalysis{
    Name:            projectName,
    ProjectType:     "unknown",
    Confidence:      0,
    LanguageVersion: "",
    DetectedTools:   []assist.ToolInfo{},
    SourceDirs:      []string{},
    TestDirs:        []string{},
    EntryPoints:     []string{},
    BuildOutputDir:  "",
}
composer := assist.NewComposer(analysis, []assist.CheckRecommendation{})
prompt := composer.Compose()
```

## Benefits

1. **Reduced Coupling**: `init.go` now depends only on `assist` and `templates` packages, not on the heavyweight `inspector` package
2. **Simplified Logic**: Removed intermediate function layer; direct use of `assist.Composer` is clearer
3. **No Functional Change**: All behavior remains identical; tests verify section headers are generated correctly
4. **Foundation for Future Work**: Clears the path for future inspector package simplification (task vibeguard-hbi depends on this work)

## Test Updates

Updated test assertions to match the actual section headers generated by `assist.Composer`:

### Changes
- `internal/cli/init_test.go`: Updated `TestRunAssist_OutputToFile` to expect "## Identifying Quality Checks" instead of "## Recommended Checks" (when no recommendations are provided)
- `internal/cli/inspector/prompt_test.go`: Updated `TestGenerateSetupPrompt` to verify correct section headers from the assist system

### Test Results
- All CLI tests pass: ✓
- All inspector tests pass: ✓
- All assist tests pass: ✓
- `vibeguard check` passes: ✓

## Impact Assessment

### Direct Impact
- **Files Modified**: 3 (init.go, init_test.go, prompt_test.go)
- **Lines Added**: ~13 (inlined function body)
- **Lines Removed**: ~1 (inspector import and function call)
- **Breaking Changes**: None

### Dependency Chain
This change unblocks task **vibeguard-a08** (Update tests for assist mode without detection), which depends on this simplification.

## Next Steps

1. ✓ Remove unused inspector imports from init.go - DONE
2. ✓ Update affected tests - DONE
3. ✓ Verify all checks pass - DONE
4. (Future) Consider deprecation of unused inspector functions once vibeguard-hbi (Remove detection pipeline from runAssist) is complete
5. (Future) Phase 3B simplifications: Remove starterConfig, simplify recommendations system

## Related Work

This is part of the **Init Template System Simplification** effort (see `docs/specs/init-template-system-spec.md`):
- **Phase 1**: Add --list-templates flag and assist integration (COMPLETE)
- **Phase 3A**: Quick wins - delete examples, remove assist/templates.go (PENDING)
- **Phase 3B**: Architectural simplification - remove starterConfig (PENDING)
- **Phase 3C**: Deep refactoring - complete rewrite of recommendations system (PENDING)

This change is a prerequisite for Phase 3A work, as it removes a dependency on the inspector package's detection capabilities.

## References

- **Beads Issue**: vibeguard-h58 (completed)
- **Blocking Issue**: vibeguard-hbi (Remove detection pipeline from runAssist)
- **Blocked By**: (none)
- **Blocks**: vibeguard-a08 (Update tests for assist mode without detection)
- **Specification**: docs/specs/init-template-system-spec.md (Phase 1, Phase 3A-3C)
- **ADRs**: ADR-005 (Adopt VibeGuard for Policy Enforcement), ADR-003 (Adopt Go)
